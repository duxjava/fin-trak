# Работа с базой данных

## Автоматические миграции

Проект настроен для автоматического запуска миграций при локальной разработке с использованием стандартных команд Drizzle Kit.

### Как это работает

1. При запуске `npm run dev` автоматически применяются миграции к базе данных
2. Drizzle Kit использует созданные SQL файлы миграций для синхронизации схемы

### Доступные команды

- `npm run dev` - Запуск в режиме разработки с автоматическими миграциями
- `npm run dev:no-migrate` - Запуск в режиме разработки без миграций
- `npm run db:generate` - Генерация миграций из схемы (создание SQL файлов)
- `npm run db:up` - Применение миграций к базе данных
- `npm run db:deploy` - Деплой миграций в продакшн
- `npm run db:studio` - Открытие Drizzle Studio для просмотра данных

### Настройка

Убедитесь, что переменная окружения `DATABASE_URL` установлена в файле `.env.local`:

```
DATABASE_URL=postgresql://username:password@localhost:5432/database_name
```

### Первый запуск

1. Установите зависимости: `npm install`
2. Настройте базу данных и переменные окружения
3. Создайте миграции: `npm run db:generate`
4. Запустите: `npm run dev`

### Рабочий процесс

1. **Изменение схемы**: Редактируйте файл `lib/schema.ts`
2. **Создание миграции**: `npm run db:generate`
3. **Применение миграции**: `npm run db:up` или просто `npm run dev`

### Разница между командами

- `db:up` - применяет созданные SQL миграции (рекомендуется для продакшена)
- `db:generate` - создает SQL файлы миграций из схемы
